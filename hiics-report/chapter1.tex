\chapter{研修の目的・目標}
\section{OSS・Linuxを使ったシステムの機能安全認証を実現する方法の研究}
近年、組込みシステムから業務ソフトまであらゆるITソリューションに対する要求が大規模化・複雑化してきており、従来は各社が独自にクローズドに開発していた領域でもオープンソースの力を利用しないと競争力のあるソリューション開発や提案が現実的にできなくなりつつある。
世界的にIT業界がオープンソースへシフトしていく流れの中で、自動車、鉄道、産業機器分野など安全性が厳しく要求される分野でも同様に\acrshort{gnu}/\acrshort{linux}をはじめとしたオープンソースを利用した開発が行われている。
このような人命が関わるようなシステム開発は国際的に定められた機能安全規格(\acrshort{iec61508}, \acrshort{iso26262}など)に準拠し第三者機関によって認証を取得することが事実上必須の市場参入要件となりつつある。
これまで、機能安全対応の開発を行う場合は開発対象となる全ての部品(ハードウェア・ソフトウェア)について開発プロセスを厳密に定め全てを自社内で管理・評価することが一般的であったが、オープンソースソフトウェアを利用する場合は次の２点の前提が問題となる。
\begin{itemize}
  \item オープンソースソフトウェアそれ自体は安全性を保証しない
  \item コミュニティごとに独自流儀の開発方法を持っている
\end{itemize}
\par
このような特性を持つ第三者が開発したオープンソースソフトウェアを部品として統合し機能安全対応の製品を構成するためには、利用する部品のどの箇所が規格に準拠していないかを特定して、規格に準拠しない箇所を補完するような対策を講じる必要がある。
このための、\acrshort{oss}・\acrshort{linux}を使用したシステムの機能安全対応プロセスおよびソフトウェア検証手法の確立を目的としたプロジェクト\acrshort{sil2linuxmp}が2015年4月に発足した。
日立は\acrshort{sil2linuxmp}プロジェクト開始当初からレビューパートナーとして参加しており、\acrshort{sil2linuxmp}コミュニティと連携した活動を\gls{hil}が中心となって進めている。
\acrshort{hiics}は\acrshort{oss}・\acrshort{linux}システムの機能安全対応または一般に品質保証の分野で自社のビジネス拡大を見据えており、日立の\acrshort{sil2linuxmp}への活動をスポンサーしている関係にある。
本研修の第一の目標は、\acrshort{hil}の研究者と共同で\acrshort{oss}・\acrshort{linux}システムの機能安全認証プロセスとソフトウェア検証技法の調査研究を行うことで、
%\acrshort{sil2linuxmp}の成果から
\acrshort{hiics}のビジネスに還元できるようなノウハウを得ることである。

\section{ソフトウェア形式検証や機能安全の専門知識を持つ海外のエンジニアとの関係構築}
\acrshort{sil2linuxmp}プロジェクトではリファレンスとなる製品とユースケースを想定して機能安全認証プロセスの策定および検証手法の開発を行う。
しかし実際に市場に出る製品の機能安全対応を行う際は、\acrshort{sil2linuxmp}のリファレンスで確立されたプロセスと手法をそのまま再利用することはできず、必ず個々の製品仕様とユースケースに応じてカスタマイズしたプロセスと手法が必要となる。
そのためには機能安全規格書を読み解き、独自の製品に対応して解釈・対応することが必要になるが、一般にソフトウェア技術者にとって\acrshort{iec61508}等の規格書は難解であるため認証規格を熟知したエキスパートの協力が必要不可欠となる。
\acrshort{sil2linuxmp}プロジェクトは\acrshort{linux} Kernelの産業用途向けリアルタイム対応を推進するドイツの非営利団体\gls{osadl}と\acrshort{ot}が主催している。
プロセス策定に関わるパートナーとしてBMW, Intel, Bosch, Elektrobit, KUKA, Renesas等の産業機器向けアプリケーションを持つ企業が、技術支援を行う学術団体としてフランスの研究機関\acrshort{inria}およびロシアと中国の研究機関が、機能安全認証機関として\acrshort{tuv}が参画している。
本研修の第二の目標は、日立から\acrshort{sil2linuxmp}コミュニティに対して認証プロセスや検証手法のレビュー、質疑応答、技術的フィードバックを行うことを通して、プロジェクトに参加している各分野のエキスパートと意見を交換できるような関係を構築していくことである。
これにより\acrshort{sil2linuxmp}プロジェクト終了後も機能安全やソフトウェア検証に関する知見を継続的に蓄積できるようにし、
%\acrshort{hiics}内に蓄積し、
また日立のオープンソースコミュニティへの活動と貢献を外部にアピールしていくことが目的である。
\chapter{業務研修内容}
\section{OSS・Linuxに対するソフトウェア検証手法・ツールの調査}
オープンソースソフトウェア自体で保証されていない品質を補完するためには各種ツールの利用が有効である。
ツールは認証対象の補完すべき品質に対するエビデンスを生成するという目的に従って選定・評価して用いる。
品質保証のためのツールとして一般的なものにはソースコードの静的検証やテスト自動化を目的とする検証ツールがあるが、それ以外にも以下のような様々なタスクが品質保証には求められる。
\begin{itemize}
  \item テストケース自動生成
  \item 動的回帰テスト
  \item バグ抽出(\acrshort{fp}フィルタリング)
  \item バグレポート生成・バグ管理
  \item テスト結果蓄積
  \item メトリクス測定・テストレポート生成
\end{itemize}
\par
特にテストケース・テスト結果・バグのマネジメントは重要であるが、人手で行うには非常に手間がかかるタスクである。
ゆえにこれらのタスクからなる品質管理ライフサイクルをいかにして効率的に回すことができるかが持続的な品質管理にとって決定的に重要である。
%幸いなことに
これらのタスクをサポートまたは自動化するツールはオープンソースライセンスで利用可能なものが多数存在する。
ただしプロジェクトによってはツール自体が十分に成熟していなかったり、開発が中断していたり、目的に沿った結果が得られない等の場合がある。
そのため、予めどのような用途にはどのツールが利用可能でどのプロジェクトでどれだけの利用実績があるかを調査すること、および自身の手で実験・評価をすることが重要である。
また、\acrshort{sil2linuxmp}プロジェクト自体でもいくつか特定のツールが採用候補として検討されているため、それらを独自に評価して用途、使用方法、解析方法、拡張性、制約、性能を理解しておくことが必要である。
本研修では、機能安全または品質保証に適用できる可能性のあるツールおよび技法に対する調査を行った。

\section{SIL2LinuxMPの戦略と規格準拠プロセスの理解}
\acrshort{sil2linuxmp}では、鉄道、自動車、航空機、産業機器、医療機器など各分野に特化した機能安全規格ではなく、それらを広くカバーする"umbrella standard"である\acrshort{iec61508}を対象とする。
現状\acrshort{oss}・\acrshort{linux}システムを対象とした機能安全規格は存在せず、\acrshort{oss}・\acrshort{linux}システム一般に機能安全認証方法論の確立を正攻法で目指す試みとしては\acrshort{sil2linuxmp}が初めてである。
\acrshort{sil2linuxmp}のリファレンスユースケースを対象とした認証プロセスを確立できた後は、それがモデルケースとして再利用され各ベンダが各々のアプリケーションに適用・拡張することが想定されている。
\par
機能安全規格\acrshort{iec61508}には製品の認証方法として以下の３通りの方法が示されている(\acrshort{iec61508}-3 7.4.2.12)。
\begin{itemize}
\label{3route}
  \item Route $1_S$: compliant development（初めから最後まで全て厳格に品質管理されたプロセスの下で開発・評価を行う）
  \item Route $2_S$: proven in use（十分な使用実績をエビデンスとして認証の根拠とする）
  \item Route $3_S$: assessment of non-compliant development（規格非適合の箇所に対して対策を行い適合と証明するに十分な根拠を与える）
\end{itemize}
\par
\acrshort{sil2linuxmp}ではこのうちRoute \textbf{$3_S$}: assessment of non-compliant developmentを採用する。
オープンソースソフトウェアは第三者が各々独自のスタイルで開発しているため$1_S$のように厳格な品質管理がされているという保証が一般に得られない。
また$2_S$で認証できるものは特定のハードウェアとソフトウェアおよびその構成と固定された設定のみであり、これは将来\acrshort{sil2linuxmp}の成果を再利用して多様なアプリケーションに拡張する方針であることに反する。
\acrshort{sil2linuxmp}のRoute $3_S$による基本的なアプローチは、製品の部品となるソフトウェアおよび開発ツールについて採用基準となる評価項目を\acrshort{iec61508}に従って定め、候補となるオープンソースのリソースから適切なものを選定・評価することである。
$3_S$による方法では、定義された選定・評価により開発・検証ツールセットを構成して規格非適合箇所を補完するエビデンスを生成し、それをもって機能安全認証機関\acrshort{tuv}に説明を行うこととなる。
本研修では、選定された検証ツールの使用方法、組み合わせ方、および認証機関\acrshort{tuv}を納得させるためのエビデンス生成方法に焦点を当てて調査研究を行った。

\section{質疑や議論を通したSIL2LinuxMPコミュニティへのコントリビューション}
\label{contribution}
\acrshort{sil2linuxmp}コミュニティに対して活動をする意図の一つは\acrshort{hiics}がビジネスに転換するためのノウハウを引き出すことであるが、それに加えて、日立からの貢献を\acrshort{oss}コミュニティにアピールするという目的がある。
\par
オープンソースが産業界でまだメジャーではなかったころは企業が独自技術で顧客を広く囲い込むことで利益を上げる戦略が有効であり、独自技術を\acrshort{oss}化して一般に公開することは利敵行為であると捉えられていた。
むしろ、\acrshort{oss}資産はフリーライドして自社ビジネスに利用するべきものという理解が一般的であった。
しかし近年、様々な技術を\acrshort{oss}化すること、また\acrshort{oss}プロジェクトに貢献することへの価値あるいはビジネスモデルの転換が起きている。
LinuxConのような技術カンファレンスでは、キーノートや個々の発表で「何々の\acrshort{oss}プロジェクトにコントリビュートしている企業TOP10」のような紹介が頻繁に行われている。
そこでは個人名ではなく企業名ごとでの貢献度ランキングが明らかになり、貢献度の大きい企業は技術者からのリスペクトの対象となる。
またその事実がその企業のサービスやビジネスを裏付け、さらには第三者が活躍できる場を提供できる技術力を持つことが広告材料となり他社と差別化されることにつながっている。
それはまさに世界中の大手IT企業がメジャーな\acrshort{oss}プロジェクトの陣取り合戦をしている状態であり、その本流に一つも貢献の実績がなくフリーライドばかりしているような企業は非常に弱い立場にあるのが実情である。
このように、自社の活動をオープンな場でアピールし、具体的な実績として\acrshort{oss}プロジェクトへの貢献を行うことで技術市場の占有率を高めることは投資的な意味で非常に重要である。\\
　\href{https://wirelesswire.jp/2016/01/49267/}{参考ブログエントリ：The software, be open or die} \cite{die}
\par
企業の\acrshort{oss}貢献度としてオープンに評価されるほぼ唯一の指標が本流（アップストリーム）への修正・追加コード適用数である。
筆者が以前\acrshort{android}プラットフォーム開発に携わっていたとき、そこでは製品となるソースコードに独自のカスタマイズや修正を大量に加えるスタイルで開発が行われていた。
そこに元のソースコード（アップストリーム）のアップデートが行われると、現状のソースコードとの差分解析およびカスタマイズ部分の抽出をした上で新しいソースコードにカスタマイズ部分を加え直すという作業が発生し、これがしばしばプロジェクトが混乱する原因となっていた。
もし我々がアップストリーム側の開発に関わることが出来ていれば、このような製品開発にとって本質的でない作業をいくらか緩和する対策を講じることができた可能性がある。
\par
\acrshort{sil2linuxmp}の場合はメインに開発する対象がソースコードではなくドキュメントであるという違いはあるものの、
プロジェクト管理は\acrshort{git}とメーリングリストが用いられており各参加者の活動は記録され統計情報として定期的に公開される。
\acrshort{oss}活動は必然的に社外の技術者との協調が求められ、特に何らかのアクションを起こす際には「何のためになぜそれが必要か」ということを十分に説明しコミュニティに納得してもらうというハードルが存在する。
筆者はこの機会を\acrshort{oss}活動に必要なスキルを身につける場と位置づけ、%また\acrshort{hiics}の投資のため、
多くのかつ意味のあるメーリングリスト投稿と\acrshort{git}コミットを行うことを課題とした。
\section{\acrshort{codemini}技法の開発と応用例提案}
筆者が\acrshort{hil}での業務研修を開始する2015年10月より以前に、日立はソフトウェア検証手法のパフォーマンスを向上させる技法\acrshort{codemini}を開発し\acrshort{sil2linuxmp}コミュニティに対して提案をしていた。
しかしその技法を実現するための実装が不完全で使用方法や出力が洗練されておらず、さらにその効果を実証するための例を上手く挙げることができていなかったため、コミュニティからの反応がほとんどない状態であった。
筆者はこの技法について実装とドキュメントを一般に公開できるレベルにまで洗練し、かつ\acrshort{sil2linuxmp}コミュニティが興味を示すような具体的応用例を示すことでこの技法の効果への理解を得ることを課題とした。
